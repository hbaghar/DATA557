---
title: 'DATA 557: Homework Assignment 1'
author: "Hriday Baghar"
date: "January 14, 2022"
output:
  pdf_document: default
  html_notebook: default
---

<!-- Option+Cmd+R - Run all chunks  -->
<!-- Cmd+Shift+Enter - Run current chunk -->
<!-- Cmd+Option+I - Insert chunk -->

## Question 1

#### Suppose that you flip a coin 40 times and count the number of heads.

#### 1.1. What is the distribution of the number of heads assuming the coin is fair?

```{r}
N <- 40
SIMS <- 10^6

#Assume 0 = tails, 1 = heads, we are sampling from [0,1] 40 times with replacement
simulation <- colSums(replicate(SIMS, sample(x = c(0,1), size = N, replace = TRUE)))
hist(simulation)
```

From the graph above, and based on intuition, the number of heads follows a binomial distribution


#### 1.2. The sample proportion of heads has an approximately normal distribution. What are the mean and standard deviation of this distribution assuming the coin is fair?
Since we assume that the coin is fair we have, $\mu = p = 0.5$.  
We calculate standard deviation using the formula  
\begin{center}
$\sigma = \sqrt{\frac{p(1-p)}{n}}$
\end{center}
```{r}
paste("SD", round(sqrt(0.5^2/N),3), sep = " = ")
```

We can verify these using simulation results:
```{r paged.print=FALSE}
paste("Mean",mean(simulation/N), sep = " = ")
paste("SD", round(sd(simulation/N),3), sep = " = ")
```


#### 1.3. Define the Z-statistic for conducting a test of the null hypothesis that the coin is fair (i.e., has probability of a head equal to 0.5).
\begin{center}
$Z = \frac{X - np}{\sqrt{np(1-p)}}$
\end{center}

#### 1.4. Suppose the experiment results in 15 heads and 25 tails. Conduct a test of the null hypothesis with type I error probability 0.05 using the normal approximation. State the Z statistic, the p-value, and the conclusion of the test (do you reject the null hypothesis or not).

```{r}

```


#### 1.5. If you had decided to use a type I error probability of 0.1 instead of 0.05 would your conclusion be different? Explain.

```{r}

```

#### 1.6. Calculate the p-value using the binomial distribution. Do you reach the same conclusion with the binomial distribution as with the normal approximation?

```{r}

```

#### 1.7. Calculate a 95% confidence interval for the probability of a head using the normal approximation.  Does the confidence interval include the value 0.5?

```{r}

```

#### 1.8. Calculate a 90% confidence interval for the probability of a head using the normal approximation.  How does it compare to the 95% confidence interval?

```{r}

```


## Question 2
A study is done to determine if enhanced seatbelt enforcement has an effect on the proportion of drivers wearing seatbelts. Prior to the intervention (enhanced enforcement) the proportion of drivers wearing their seatbelt was 0.7. The researcher wishes to test the null hypothesis that the proportion of drivers wearing their seatbelt after the intervention is equal to 0.7 (i.e., unchanged from before). The alternative hypothesis is that the proportion of drivers wearing their seatbelt is not equal to 0.7 (either < 0.7 or > 0.7). After the intervention, a random sample of 400 drivers was selected and the number of drivers wearing their seatbelt was found to be 305.

#### 2.1. Calculate the estimated standard error of the proportion of drivers wearing seatbelts after the intervention.

#### 2.2. Calculate a 95% confidence interval for the proportion of drivers wearing seatbelts after the intervention. What conclusion would you draw based on the confidence interval?

#### 2.3. Conduct a test of the null hypothesis with type I error probability 0.05 using the normal approximation. Should the null hypothesis be rejected? How does your conclusion compare to the conclusion from the confidence interval?

#### 2.4. Calculate the approximate p-value using the normal approximation and the exact p-value using the binomial distribution.  Are the two p-values very different? 

#### 2.5. Calculate the power of the test to detect the alternative hypothesis that the proportion of drivers wearing their seatbelt after the intervention is equal to 0.8.

## Question 3
Data set: ‘iq.csv’ (data set posted on canvas)

The data come from a study of lead exposure and IQ in children. IQ scores were measured on a sample of children living in a community near a source of lead. The IQ scores were age-standardized using established normal values for the US population. Such age-standardized scores have a mean of 100 and a standard deviation of 15 in the US population.

#### 3.1. Create a histogram of the IQ variable. Is the distribution approximately normal?

#### 3.2. Calculate the sample mean and sample SD of IQ. How do they compare numerically to the US population values?

#### 3.3. Test the null hypothesis that the mean IQ score in the community is equal to 100 using the 2-sided 1-sample t-test with a significance level of 0.05. State the value of the test statistic and whether or not you reject the null hypothesis at significance level 0.05.

#### 3.4. Give the p-value for the test in the previous question. State the interpretation of the p-value.

#### 3.5. Compute a 95% confidence interval for the mean IQ.  Do the confidence interval and hypothesis test give results that agree or conflict with each other? Explain.

#### 3.6.  Repeat the hypothesis test and confidence interval using a significance level of 0.01 and a 99% confidence interval.
